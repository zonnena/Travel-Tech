---
phase: 03-ai-content
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - js/config.js
  - index.html
  - css/style.css
autonomous: true

must_haves:
  truths:
    - "Content panel slides in from the right when content is available"
    - "Panel has a close button that hides it"
    - "Panel uses current theme accent color for highlights"
    - "Config file holds the Gemini API key separate from app logic"
  artifacts:
    - path: "js/config.js"
      provides: "Gemini API key export"
      contains: "GEMINI_API_KEY"
    - path: "index.html"
      provides: "Content panel markup and script tags"
      contains: "content-panel"
    - path: "css/style.css"
      provides: "Content panel styles with slide animation and loading skeleton"
      contains: "content-panel"
  key_links:
    - from: "index.html"
      to: "js/config.js"
      via: "script tag before ai.js"
      pattern: "script src.*config\\.js"
    - from: "css/style.css"
      to: "index.html"
      via: "content-panel class names"
      pattern: "\\.content-panel"
---

<objective>
Set up the content panel UI shell, API config, and all CSS needed for Phase 3 AI content display.

Purpose: Provides the visual container and configuration foundation that the AI service (Plan 02) will populate with generated content.
Output: js/config.js with API key, content panel HTML in index.html, full panel CSS with slide animation, loading skeleton, and theme-aware styling.
</objective>

<execution_context>
@C:\Users\Admin\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\Admin\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@index.html
@css/style.css
@js/app.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create config file and add content panel markup</name>
  <files>js/config.js, index.html</files>
  <action>
1. Create `js/config.js` with:
```js
// GeoLayers — Configuration
// For hackathon demo only. In production, use a backend proxy.
var GEO_CONFIG = {
  GEMINI_API_KEY: 'PASTE_YOUR_KEY_HERE',
  GEMINI_ENDPOINT: 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent'
};
```
Note: The user will paste their actual key. The file exposes a global `GEO_CONFIG` object.

2. Edit `index.html` — add the content panel markup BEFORE the Leaflet script tag (before the closing `</body>` but after the status pill div):
```html
<!-- AI Content Panel (slides in from right) -->
<div id="content-panel" class="content-panel">
  <div class="content-panel__header">
    <div class="content-panel__title-row">
      <h2 id="content-panel-title" class="content-panel__title">Ancient Archaeology</h2>
      <span class="content-panel__badge">AI Generated</span>
    </div>
    <button id="content-panel-close" class="content-panel__close" aria-label="Close panel">&times;</button>
  </div>
  <div id="content-panel-body" class="content-panel__body">
    <!-- Loading skeleton (shown while fetching) -->
    <div id="content-loading" class="content-panel__loading">
      <div class="skeleton-line skeleton-line--long"></div>
      <div class="skeleton-line skeleton-line--medium"></div>
      <div class="skeleton-line skeleton-line--long"></div>
      <div class="skeleton-line skeleton-line--short"></div>
      <div class="skeleton-line skeleton-line--long"></div>
      <div class="skeleton-line skeleton-line--medium"></div>
    </div>
    <!-- AI content goes here -->
    <div id="content-text" class="content-panel__text"></div>
  </div>
</div>
```

3. In `index.html`, add two script tags AFTER the Leaflet JS script and BEFORE the app.js script:
```html
<script src="js/config.js"></script>
<script src="js/ai.js"></script>
```
The final script order must be: leaflet.js -> config.js -> app.js -> ai.js. Actually, ai.js should come AFTER app.js since it depends on window.geoState being initialized. So the order is:
- leaflet.js
- config.js (before app.js so GEO_CONFIG is available)
- app.js
- ai.js (last, since it reads window.geoState and listens for events dispatched by app.js)
  </action>
  <verify>Open index.html in browser — content panel div exists in DOM (inspect elements), no console errors from missing scripts (ai.js won't exist yet, that's Plan 02 — but config.js should load without error).</verify>
  <done>index.html contains content-panel markup, loads config.js and has script tag placeholder for ai.js. js/config.js exists with GEO_CONFIG global.</done>
</task>

<task type="auto">
  <name>Task 2: Add content panel CSS with slide animation and loading skeleton</name>
  <files>css/style.css</files>
  <action>
Append the following CSS sections to `css/style.css`:

1. **Content Panel base styles:**
```css
/* --- AI Content Panel --- */
.content-panel {
  position: fixed;
  top: var(--header-height);
  right: 0;
  bottom: 0;
  width: 380px;
  max-width: 90vw;
  background: rgba(18, 18, 26, 0.95);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border-left: 1px solid rgba(var(--theme-accent-rgb), 0.2);
  z-index: 1200;
  transform: translateX(100%);
  transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1), border-left-color 0.5s ease;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.content-panel--open {
  transform: translateX(0);
}
```

2. **Panel header with close button:**
```css
.content-panel__header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  padding: 20px 20px 12px;
  border-bottom: 1px solid rgba(var(--theme-accent-rgb), 0.1);
  flex-shrink: 0;
}

.content-panel__title-row {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.content-panel__title {
  font-family: var(--font-display);
  font-size: 1.15rem;
  font-weight: 700;
  color: var(--theme-accent);
  letter-spacing: -0.01em;
  transition: color 0.5s ease;
}

.content-panel__badge {
  display: inline-block;
  font-size: 9px;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  color: var(--text-secondary);
  background: rgba(255, 255, 255, 0.06);
  padding: 2px 8px;
  border-radius: 4px;
  width: fit-content;
}

.content-panel__close {
  background: rgba(255, 255, 255, 0.06);
  border: 1px solid rgba(255, 255, 255, 0.1);
  color: var(--text-secondary);
  font-size: 1.3rem;
  width: 32px;
  height: 32px;
  border-radius: 8px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
  flex-shrink: 0;
}

.content-panel__close:hover {
  background: rgba(255, 255, 255, 0.12);
  color: var(--text-primary);
}
```

3. **Panel body and text:**
```css
.content-panel__body {
  flex: 1;
  overflow-y: auto;
  padding: 20px;
  scrollbar-width: thin;
  scrollbar-color: rgba(var(--theme-accent-rgb), 0.3) transparent;
}

.content-panel__body::-webkit-scrollbar {
  width: 4px;
}

.content-panel__body::-webkit-scrollbar-thumb {
  background: rgba(var(--theme-accent-rgb), 0.3);
  border-radius: 2px;
}

.content-panel__text {
  font-size: 0.92rem;
  line-height: 1.7;
  color: var(--text-primary);
}

.content-panel__text p {
  margin-bottom: 1em;
}

.content-panel__text p:last-child {
  margin-bottom: 0;
}
```

4. **Loading skeleton animation:**
```css
/* --- Loading Skeleton --- */
.content-panel__loading {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.content-panel__loading--hidden {
  display: none;
}

.skeleton-line {
  height: 14px;
  background: linear-gradient(
    90deg,
    rgba(var(--theme-accent-rgb), 0.06) 25%,
    rgba(var(--theme-accent-rgb), 0.12) 50%,
    rgba(var(--theme-accent-rgb), 0.06) 75%
  );
  border-radius: 4px;
  animation: shimmer 1.5s ease-in-out infinite;
  background-size: 200% 100%;
}

.skeleton-line--long { width: 100%; }
.skeleton-line--medium { width: 75%; }
.skeleton-line--short { width: 50%; }

@keyframes shimmer {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}
```

5. **Mobile responsive adjustments** (inside the existing `@media (max-width: 480px)` block):
```css
.content-panel {
  width: 100%;
  max-width: 100vw;
}
```
  </action>
  <verify>Open browser, inspect content-panel element — verify the panel is hidden offscreen (translateX 100%). Manually add `content-panel--open` class via DevTools — panel should slide in from the right with blur background. Loading skeleton lines should shimmer with theme accent color.</verify>
  <done>Content panel has full styling: slide-in animation, themed accent title, close button, scrollable body, loading skeleton with shimmer, responsive mobile fullwidth. All colors use CSS custom properties so they auto-shift with theme changes.</done>
</task>

</tasks>

<verification>
1. Open index.html in browser with DevTools — no console errors
2. Inspect #content-panel — exists in DOM, hidden off-right via transform
3. Toggle .content-panel--open class — panel slides smoothly from right
4. Loading skeleton lines visible and animated when panel is open
5. Switch theme class on body (theme-medieval, etc.) — panel border and title color shift
6. js/config.js loaded, `GEO_CONFIG` accessible in console
</verification>

<success_criteria>
- Content panel markup exists in index.html with proper structure
- Panel CSS provides slide-in animation, themed colors, loading skeleton
- js/config.js creates global GEO_CONFIG with API key placeholder and endpoint
- Script loading order is correct: leaflet -> config -> app -> ai
- No console errors
</success_criteria>

<output>
After completion, create `.planning/phases/03-ai-content/03-01-SUMMARY.md`
</output>
